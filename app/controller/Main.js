/*
 * File: app/controller/Main.js
 *
 * This file was generated by Sencha Architect version 3.1.0.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 4.2.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 4.2.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */
// @define Gnt.model.Task

    Ext.define('MyApp.controller.Main', {
        extend: 'Ext.app.Controller',

        id: 'Main',
        /*requires:[
            'DSch.plugin.exporter.AbstractExporter',
            'DSch.plugin.exporter.MultiPageHorizontal',
            'DSch.plugin.exporter.SinglePage',
            'DSch.plugin.Export',
            'Sch.plugin.ExcelExport',
            'DGnt.plugin.exporter.MultiPageHorizontal',
            'DGnt.plugin.exporter.SinglePage',
            'Gnt.model.Task',
            'Gnt.plugin.ProjectLines'
        ],*/
        refs: [
            {
                ref: 'myPanel',
                selector: '#myPanel'
            },
            {
                ref: 'mainViewport',
                selector: '#myviewport'
            },
            {
                ref: 'mainViewport2',
                selector: '#myviewport'
            },
            {
                ref: 'MainView',
                selector: '#MainView'
            },
            {
                ref: 'mytreepanel',
                selector: '#mytreepanel'
            },
            {
                ref: 'version',
                selector: '#version'
            }
        ],

        onAufnrKeypress: function(textfield, e, eOpts) {
            var me = this;
            if (e.getCharCode() === e.ENTER) {
                // enter pressed
                me.loadTaskStore(textfield.value);
            }
        },

        onAufnrChange: function(field, newValue, oldValue, eOpts) {
            var me = this;
            if (field.searchGo) {
                field.searchGo = false;
                me.loadTaskStore(newValue);
            }
        },

        onButtonClick1: function(button, e, eOpts) {
            var me = this;
            var myPanel = Ext.widget('mypanel');
            var mainView = Ext.widget('mainview');
            var taskStore = Ext.store('taskstore');
            mainView.setLoading(true);
            taskStore.sync({
                callback: function() {
                    mainView.removeAll();
                    mainView.insert(0,myPanel);
                    mainView.setLoading(false);
                }
            });

        },

        /** Rebuilds based on Changed Config **/
        onEventTriggerGanttConfig: function(component, config, eventOptions) {

            var me = this;
            if(!Ext.isDefined(component)){
                component = Ext.ComponentManager.get('myPanel');
                config = me.myPanelConfig;
            }
            me.myPanelConfig = config;
            var mainView = Ext.ComponentManager.get('mainView');//Ext.widget('mainview');
            var ganttConfigStore = Ext.getStore('GanttConfigStoreXml');
            var yesNoStore  = Ext.getStore('YesNoStore');
            var selectedRecord;
            var ganttExists = yesNoStore.findExact('name','ganttExists');

            var panelWidth = mainView.getWidth();
            var panelHeight = mainView.getHeight();
            var panelThird = panelWidth/3;
            //finishDate
            var finishRecordIndex = ganttConfigStore.findExact('name','finish');
            var finishRecord = ganttConfigStore.getAt(finishRecordIndex);
            var finishValue = finishRecord.get('value').length < 10 ? new Date().toString() : finishRecord.get('value');
            finishValue = new Date(finishValue.replace(/\D/ig,'-'));
            finishValue = finishValue.setMonth(finishValue.getMonth()+6);
            //startDate
            var startRecordIndex = ganttConfigStore.findExact('name','start');
            var startRecord = ganttConfigStore.getAt(startRecordIndex);
            var startValue = startRecord.get('value').length < 10 ? new Date().toString() : startRecord.get('value');
            startValue = new Date(startValue.replace(/\D/ig,'-'));
            startValue = startValue.setMonth(startValue.getMonth()-6);
            //columnVariant
            var columnVariantSelectedRecord = ganttConfigStore.findExact('name','columnVariant');
            var columnVariantRecord = ganttConfigStore.getAt(columnVariantSelectedRecord);
            var columnVariantValue = columnVariantRecord.get('value');
            //selectionVariant
            var selectionVariantSelectedRecord = ganttConfigStore.findExact('name','selectionVariant');
            var selectionVariantRecord = ganttConfigStore.getAt(selectionVariantSelectedRecord);
            var selectionVariantValue = selectionVariantRecord.get('value');
            //version
            var versionSelectedRecord = ganttConfigStore.findExact('name','version');
            var versionRecord = ganttConfigStore.getAt(versionSelectedRecord);
            var versionValue = versionRecord.get('value');

            //status date
            var statusDateSelectedRecord = ganttConfigStore.findExact('name','statusDate');
            var statusDateRecord = ganttConfigStore.getAt(statusDateSelectedRecord);
            var statusDateValue = statusDateRecord.get('value');

            var lineStore = Ext.create('Ext.data.JsonStore', {
                model : 'MyApp.model.Line',
                data  : [
                    {
                        Date : new Date(statusDateValue.replace(/\D/ig,'-')),
                        Text : 'Status Date',
                        Cls  : 'important'
                    }
                ]
            });
           if (ganttExists != -1){
                var ganttPanelCmp = Ext.getCmp('ganttPanel');
                ganttPanelCmp.lockedGrid.reconfigure(null, me.ganttColumns());

                /*var ganttPanel = Ext.ComponentManager.get('ganttPanel');
                var lockedGrid = ganttPanel.lockedGrid;
                //lockedGrid.addEvents({
                //    itemClick: function() {
                //        console.log('josh');
                //    }
                //});
                var cols = lockedGrid.columns;
                var count = 0;
                for (var i=0; i < cols.length; i++) {
                    var col = cols[i];
                    if (col.hidden === false || typeof col.hidden === 'undefined') {
                        count++;
                    }
                   // console.log(count);
                }*/

            } else {
               var tpl = me.getBodyTpl();
               var header = me.getHeaderTpl();
               var footer = me.getFooterTpl();
                yesNoStore.add({
                    name: 'ganttExists'
                });
               component.returnValue = Ext.applyIf(config, {
                   taskStore: me.taskStore,
                   lockedGridConfig:{
                       width: panelThird,
                       resizable: 'w e'
                   },
                   readOnly: true,
                   baselineVisible: false,
                   viewPreset: 'year',
                   width: panelWidth,
                  /* listeners: {
                       itemclick: {
                           fn: function () {
                              var ganttPanel = Ext.ComponentManager.get('ganttPanel');
                              var lockedGrid = ganttPanel.lockedGrid;
                              t.mixin.Observable#addEvents" is deprecated.
                              lockedGrid.addEvents({
                                   itemClick: function() {
                                       console.log('josh');
                                   }
                               });
                               var cols = lockedGrid.columns;
                               var count = 0;
                               for (var i=0; i < cols.length; i++) {
                                   var col = cols[i];
                                   if (col.hidden === false || col.hidden === undefined) {
                                       count = count + 1;
                                   }
                               }
                           },
                           scope: me
                       }
                   },*/
                   plugins: [
                       Ext.create("Sch.plugin.Lines", {
                           showHeaderElements : true,
                           innerTpl           : '<span class="line-text">{Text}</span>',
                           store              : lineStore
                       }),
                       Ext.create("DSch.plugin.Export", {
                           pluginId: 'exportServer',
                           name:'Export',
                           printServer     : window.server,
                           printPDFServer  : window.server,
                           tpl : tpl,
                           headerTpl : header,
                           footerTpl : footer,
                           afterExport :  function (gantt) {
                               Ext.Ajax.useDefaultXhrHeader = true;
                           },
                           beforeExport : function (gantt) {
                               Ext.Ajax.useDefaultXhrHeader = false;
                           }
                       })
                       //new Sch.plugin.ExcelExport()
                   ],
                   height: panelHeight-75,
                   startDate: new Date(startValue),
                   endDate: new Date(finishValue),
                   rightLabelField: {
                       renderer : function (value, record){
                           var color = record.get('color');
                           var depth = record.getDepth();
                           if (color === 'red' && depth < 3) {
                               var rightLabel = record.get('Note');
                               return rightLabel;
                           } if (color === 'lightBlue') {
                              var duration = record.get('smDuration');
                               return Ext.isEmpty(duration) || isNaN(duration) ? 0+' days' : (Number(duration) === 1 ? Number(duration) +' day' : Number(duration)+' days');
                           } else {

                               var endDate = Ext.isEmpty(record.get('EndDate')) ? new Date(): record.get('EndDate');
                               var rightLabel = endDate instanceof Date ? endDate : Ext.isNull(endDate) ? 'Invalid Date' : new Date(endDate.replace(/\D/ig,'-')+'T00:00:00');//record.get('EndDate');
                               if(rightLabel === 'Invalid Date'){
                                   return endDate;
                               }
                               var mth = rightLabel.getUTCMonth()+1;
                               var day = rightLabel.getUTCDate();
                               var yr = rightLabel.getUTCFullYear();
                               /**
                                * date: 2017/12/15 CH
                                * This is commented as it caused 02-01-2017 to return 01-31-2017
                                * probably this was used to balence the adding of a day to the endDate in SAP which has been removed
                               if (day-1===0) {
                                   switch (mth) {
                                       case 1:
                                           mth = mth -1;
                                           day = '31';
                                           break;
                                       case 2:
                                           mth = mth -1;
                                           day = '31';
                                           break;
                                       case 3:
                                           mth = mth -1;
                                           day = '28';
                                           break;
                                       case 4:
                                           mth = mth -1;
                                           day = '31';
                                           break;
                                       case 5:
                                           mth = mth -1;
                                           day = '30';
                                           break;
                                       case 6:
                                           mth = mth -1;
                                           day = '31';
                                           break;
                                       case 7:
                                           mth = mth -1;
                                           day = '30';
                                           break;
                                       case 8:
                                           mth = mth -1;
                                           day = '31';
                                           break;
                                       case 9:
                                           mth = mth -1;
                                           day = '31';
                                           break;
                                       case 10:
                                           mth = mth -1;
                                           day = '30';
                                           break;
                                       case 11:
                                           mth = mth -1;
                                           day = '31';
                                           break;
                                       case 12:
                                           mth = mth -1;
                                           day = '30';
                                           break;
                                   }
                               }
                               else {
                                    day = day-1;
                                }*/
                               rightLabel = mth+'/'+day+'/'+yr;
                               return rightLabel;
                           }
                       }
                   },
                   leftLabelField: {
                       renderer : function (value, record){
                           var color = record.get('color');
                           if (color !=='lightBlue'){

                               var startDate = Ext.isEmpty(record.get('StartDate')) ? new Date() : record.get('StartDate');
                               var leftLabel =  startDate instanceof Date ? startDate : Ext.isNull(startDate) ? 'Invalid Date' : new Date(startDate.replace(/\D/ig,'-')+'T00:00:00');//record.get('StartDate');
                               if(leftLabel == 'Invalid Date'){
                                   return startDate;
                               }
                               var mth = leftLabel.getUTCMonth()+1;
                               var day = leftLabel.getUTCDate();
                               var yr = leftLabel.getUTCFullYear();
                               leftLabel = mth+'/'+day+'/'+yr;
                               return leftLabel;
                           } else {
                               var leftLabelAlt = 'MR';
                               return leftLabelAlt;
                           }
                       }
                   },
                   eventRenderer : function (task) {
                       var color = task.get('color');
                       var style = Ext.String.format('background-color: #{0};border-color:#{1}');
                       if (color !=='') {
                           switch (color) {
                               case 'red':
                                   style = Ext.String.format('background-color: #{0};border-color:#{1}', 'FF0000', 'FF0000');
                                   progressBarStyle = Ext.String.format('background-color: #{0};border-color:#{1}', '000000', '000000');
                                   cls = Ext.String.format('background-color: #{0};border-color:#{1}', 'ff0000', 'ff0000');
                                   return {
                                       style: style,
                                       progressBarStyle: progressBarStyle,
                                       cls: cls
                                   };
                               //orange
                               case 'orange':
                                   style = Ext.String.format('background-color: #{0};border-color:#{1}', 'FFA500', 'FFA500');
                                   progressBarStyle = Ext.String.format('background-color: #{0};border-color:#{1}', '000000', '000000');
                                   cls = Ext.String.format('background-color: #{0};border-color:#{1}', 'ffa500', 'ffa500');
                                   return {
                                       style: style,
                                       progressBarStyle: progressBarStyle,
                                       cls: cls
                                   };
                               case 'blue':
                                   style = Ext.String.format('background-color: #{0};border-color:#{1}', '9B9BD7', '9B9BD7');
                                   progressBarStyle = Ext.String.format('background-color: #{0};border-color:#{1}', '000000', '000000');
                                   cls = style;
                                   return {
                                       style: style,
                                       progressBarStyle: progressBarStyle,
                                       cls: cls
                                   };
                               case 'yellow':
                                   style = Ext.String.format('background-color: #{0};border-color:#{1}', 'FFFF80', 'FFFF80');
                                   progressBarStyle = Ext.String.format('background-color: #{0};border-color:#{1}', 'FFFF80', 'FFFF80');
                                   cls = style;
                                   return {
                                       style: style,
                                       progressBarStyle: progressBarStyle,
                                       cls: cls
                                   };
                               case 'gray':
                                   style = Ext.String.format('background-color: #{0};border-color:#{1}', 'BEBEB1', 'BEBEB1');
                                   progressBarStyle = Ext.String.format('background-color: #{0};border-color:#{1}', '000000', '000000');
                                   cls = style;
                                   return {
                                       style: style,
                                       progressBarStyle: progressBarStyle,
                                       cls: cls
                                   };
                               case 'euTracker':
                               case 'green':
                                   style = Ext.String.format('background-color: #{0};border-color:#{1}', '80B280', '80B280');
                                   progressBarStyle = Ext.String.format('background-color: #{0};border-color:#{1}', '000000', '000000');
                                   cls = style;
                                   return {
                                       style: style,
                                       progressBarStyle: progressBarStyle,
                                       cls: cls
                                   };
                               case 'lightBlue':
                                   style = Ext.String.format('background-color: #{0};border-color:#{1}', '80B280', '80B280');
                                   progressBarStyle = Ext.String.format('background-color: #{0};border-color:#{1}', '000000', '000000');
                                   cls = style;
                                   return {
                                       style: style,
                                       progressBarStyle: progressBarStyle,
                                       cls: cls
                                   };
                           }
                       } else {
                           //green
                           style = Ext.String.format('background-color: #{0};border-color:#{1}', '80B280', '80B280');
                           progressBarStyle = Ext.String.format('background-color: #{0};border-color:#{1}', '000000', '000000');
                           cls = style;
                           return {
                               style: style,
                               progressBarStyle: progressBarStyle,
                               cls: cls
                           };
                       }
                   },
                   columns: me.ganttColumns()
               });
            }


                console.log('end reformat');

        },

        ganttColumns:function(){
            var searchText = "Icon FA Icon S/T Icon Fab",
                textArray = [],
                ganttConfigStore = Ext.getStore('GanttConfigStoreXml');
                ganttConfigStore.filter(function(model){
                    return model.get('name').indexOf('text') > -1
                });

            try {
                ganttConfigStore.each(function(model){
                    var textValue = model.get('value');
                    textArray.push({
                        xtype : 'gridcolumn',//searchText.indexOf(textValue) > -1 ? 'templatecolumn' : 'gridcolumn',
                        dataIndex: model.get('name'),//example : 'text01'
                        header: textValue,
                        hidden: textValue === 'Not Used',
                        renderer: function (value, metadata, record, rowIdx, colIdx, store, view){
                            //var backgroundColor = record.get('color');
                            //value = searchText.indexOf(textValue) > -1 ? '#ICON_3#' : value;
                            switch (value) {
                                //active      // G.png
                                case '#ICON_1#':
                                    //metadata.css = 'ula-icon-2';
                                    return '<img class="ula-icon" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAOCAYAAADwikbvAAAACXBIWXMAAGIHAABiBwHvW/JZAAA4HGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS41LWMwMjEgNzkuMTU0OTExLCAyMDEzLzEwLzI5LTExOjQ3OjE2ICAgICAgICAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgICAgICAgICAgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIgogICAgICAgICAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgICAgICAgICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIj4KICAgICAgICAgPHhtcDpDcmVhdG9yVG9vbD5BZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpPC94bXA6Q3JlYXRvclRvb2w+CiAgICAgICAgIDx4bXA6Q3JlYXRlRGF0ZT4yMDE0LTA4LTE0VDE1OjA0OjQ2LTA3OjAwPC94bXA6Q3JlYXRlRGF0ZT4KICAgICAgICAgPHhtcDpNb2RpZnlEYXRlPjIwMTQtMDgtMTRUMTU6MDU6NDgtMDc6MDA8L3htcDpNb2RpZnlEYXRlPgogICAgICAgICA8eG1wOk1ldGFkYXRhRGF0ZT4yMDE0LTA4LTE0VDE1OjA1OjQ4LTA3OjAwPC94bXA6TWV0YWRhdGFEYXRlPgogICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3BuZzwvZGM6Zm9ybWF0PgogICAgICAgICA8cGhvdG9zaG9wOkNvbG9yTW9kZT4zPC9waG90b3Nob3A6Q29sb3JNb2RlPgogICAgICAgICA8eG1wTU06SW5zdGFuY2VJRD54bXAuaWlkOmI0MDJkYzhiLTZmZWItYWE0OC04NzAxLWIzNjg4MGYzN2MxMjwveG1wTU06SW5zdGFuY2VJRD4KICAgICAgICAgPHhtcE1NOkRvY3VtZW50SUQ+eG1wLmRpZDpiNDAyZGM4Yi02ZmViLWFhNDgtODcwMS1iMzY4ODBmMzdjMTI8L3htcE1NOkRvY3VtZW50SUQ+CiAgICAgICAgIDx4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ+eG1wLmRpZDpiNDAyZGM4Yi02ZmViLWFhNDgtODcwMS1iMzY4ODBmMzdjMTI8L3htcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOkhpc3Rvcnk+CiAgICAgICAgICAgIDxyZGY6U2VxPgogICAgICAgICAgICAgICA8cmRmOmxpIHJkZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmFjdGlvbj5jcmVhdGVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDppbnN0YW5jZUlEPnhtcC5paWQ6YjQwMmRjOGItNmZlYi1hYTQ4LTg3MDEtYjM2ODgwZjM3YzEyPC9zdEV2dDppbnN0YW5jZUlEPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6d2hlbj4yMDE0LTA4LTE0VDE1OjA0OjQ2LTA3OjAwPC9zdEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6c29mdHdhcmVBZ2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpPC9zdEV2dDpzb2Z0d2FyZUFnZW50PgogICAgICAgICAgICAgICA8L3JkZjpsaT4KICAgICAgICAgICAgPC9yZGY6U2VxPgogICAgICAgICA8L3htcE1NOkhpc3Rvcnk+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgICAgIDx0aWZmOlhSZXNvbHV0aW9uPjYzNzQxMzAvMTAwMDA8L3RpZmY6WFJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOllSZXNvbHV0aW9uPjYzNzQxMzAvMTAwMDA8L3RpZmY6WVJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOlJlc29sdXRpb25Vbml0PjI8L3RpZmY6UmVzb2x1dGlvblVuaXQ+CiAgICAgICAgIDxleGlmOkNvbG9yU3BhY2U+NjU1MzU8L2V4aWY6Q29sb3JTcGFjZT4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjE1PC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjE0PC9leGlmOlBpeGVsWURpbWVuc2lvbj4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgCjw/eHBhY2tldCBlbmQ9InciPz7kTVOrAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAEPSURBVHjaYvjPwMCADT+VYlCblsmw8C8TAw8uNQy4JKpbGOYx/Gf4v9eJIYUkzbtdGFIY/kOg1lWGL/8ZGGSJ0nxNk8GD8xtMKwRGLGc4+5+BgRGv5usaDF58H1E1wmDiPIYT/xkYWLFqXh7B0IBdGwIanmN4+0SawQmu+ZwRQ7DRWYaXhDQiQ7edDPfOGzCEM91RZtA6Z8QgxkACOGzLoPiJj0GY4T8DA8NfJgaB2EUMe4ixtbeIYTLWAFsYx1CJSxPnN4b/Z4wZAvFG1R4nhmh0jbyfGP7fVEMEFN5EstkHkUgY/jP8P2zDEEVS8uwoZ+hl+M/wv7OMYRLJafsDP4NodQvDuleiDMq41AAGAD/hDqkvaQZYAAAAAElFTkSuQmCC"></img>';
                                //complete    // F.png
                                case '#ICON_2#':
                                    //metadata.css = 'ula-icon-3';
                                    return '<img class="ula-icon" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAACXBIWXMAAAsTAAALEwEAmpwYAAA5yWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS41LWMwMjEgNzkuMTU0OTExLCAyMDEzLzEwLzI5LTExOjQ3OjE2ICAgICAgICAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgICAgICAgICAgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIgogICAgICAgICAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgICAgICAgICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIj4KICAgICAgICAgPHhtcDpDcmVhdG9yVG9vbD5BZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpPC94bXA6Q3JlYXRvclRvb2w+CiAgICAgICAgIDx4bXA6Q3JlYXRlRGF0ZT4yMDE0LTA4LTE0VDExOjExLTA3OjAwPC94bXA6Q3JlYXRlRGF0ZT4KICAgICAgICAgPHhtcDpNb2RpZnlEYXRlPjIwMTQtMDgtMTRUMTU6MDk6NDktMDc6MDA8L3htcDpNb2RpZnlEYXRlPgogICAgICAgICA8eG1wOk1ldGFkYXRhRGF0ZT4yMDE0LTA4LTE0VDE1OjA5OjQ5LTA3OjAwPC94bXA6TWV0YWRhdGFEYXRlPgogICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3BuZzwvZGM6Zm9ybWF0PgogICAgICAgICA8cGhvdG9zaG9wOkNvbG9yTW9kZT4zPC9waG90b3Nob3A6Q29sb3JNb2RlPgogICAgICAgICA8eG1wTU06SW5zdGFuY2VJRD54bXAuaWlkOjQ1YjJjMDYyLTQ4OTktN2Y0Yy1iMTI2LTY3N2UwYjI0YjM4YTwveG1wTU06SW5zdGFuY2VJRD4KICAgICAgICAgPHhtcE1NOkRvY3VtZW50SUQ+eG1wLmRpZDo0OWQ2MzIzOC03NjZmLTExNGMtYWMyYi1jOTFjOGI0ZWMzNzQ8L3htcE1NOkRvY3VtZW50SUQ+CiAgICAgICAgIDx4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ+eG1wLmRpZDo0OWQ2MzIzOC03NjZmLTExNGMtYWMyYi1jOTFjOGI0ZWMzNzQ8L3htcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOkhpc3Rvcnk+CiAgICAgICAgICAgIDxyZGY6U2VxPgogICAgICAgICAgICAgICA8cmRmOmxpIHJkZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmFjdGlvbj5jcmVhdGVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDppbnN0YW5jZUlEPnhtcC5paWQ6NDlkNjMyMzgtNzY2Zi0xMTRjLWFjMmItYzkxYzhiNGVjMzc0PC9zdEV2dDppbnN0YW5jZUlEPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6d2hlbj4yMDE0LTA4LTE0VDExOjExLTA3OjAwPC9zdEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6c29mdHdhcmVBZ2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpPC9zdEV2dDpzb2Z0d2FyZUFnZW50PgogICAgICAgICAgICAgICA8L3JkZjpsaT4KICAgICAgICAgICAgICAgPHJkZjpsaSByZGY6cGFyc2VUeXBlPSJSZXNvdXJjZSI+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDphY3Rpb24+c2F2ZWQ8L3N0RXZ0OmFjdGlvbj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0Omluc3RhbmNlSUQ+eG1wLmlpZDo0NWIyYzA2Mi00ODk5LTdmNGMtYjEyNi02NzdlMGIyNGIzOGE8L3N0RXZ0Omluc3RhbmNlSUQ+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDp3aGVuPjIwMTQtMDgtMTRUMTU6MDk6NDktMDc6MDA8L3N0RXZ0OndoZW4+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDpzb2Z0d2FyZUFnZW50PkFkb2JlIFBob3Rvc2hvcCBDQyAoV2luZG93cyk8L3N0RXZ0OnNvZnR3YXJlQWdlbnQ+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDpjaGFuZ2VkPi88L3N0RXZ0OmNoYW5nZWQ+CiAgICAgICAgICAgICAgIDwvcmRmOmxpPgogICAgICAgICAgICA8L3JkZjpTZXE+CiAgICAgICAgIDwveG1wTU06SGlzdG9yeT4KICAgICAgICAgPHRpZmY6T3JpZW50YXRpb24+MTwvdGlmZjpPcmllbnRhdGlvbj4KICAgICAgICAgPHRpZmY6WFJlc29sdXRpb24+NzIwMDAwLzEwMDAwPC90aWZmOlhSZXNvbHV0aW9uPgogICAgICAgICA8dGlmZjpZUmVzb2x1dGlvbj43MjAwMDAvMTAwMDA8L3RpZmY6WVJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOlJlc29sdXRpb25Vbml0PjI8L3RpZmY6UmVzb2x1dGlvblVuaXQ+CiAgICAgICAgIDxleGlmOkNvbG9yU3BhY2U+NjU1MzU8L2V4aWY6Q29sb3JTcGFjZT4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjE1PC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjE1PC9leGlmOlBpeGVsWURpbWVuc2lvbj4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgCjw/eHBhY2tldCBlbmQ9InciPz5upWWbAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAALNSURBVHjalJJPaFxVGMV/97773pvMv4wzk0Qbk7QmaZuFNEVsKAhdiF2ocSOWLkRcuC8uCoUuXLrrolLUjVBwIUoDWZgIgiiCjtjBqRXTNsw8JzLJ5N80mUzmvZk3714XGaxbz+Z8HDh88OOIhYUFAIwB2449FbXXj98trZU++8E3di7P2upDGEgDBgCERIZtrLCFWlpaAkBHkE7Il7WTGr55o/AbY5NMDufBaEA8Kf9HKp8ZOLpMhBBmvJ196b13r1+8eNBpxu+V/1pA60/oHoIQ/c+gdQ9LCJTR4VEYBQQik58YPz2Tzg7NlOoB5TOvv+LIr06K6oOrJp6MAITlopsbmObfKG2lALCVgyA9+/29DcpbVcrOCL0zo0wPP/+2q9PXI8f1MSCVpG58NhsVVCYBQhgGbKV+8uLnl0vbhGMn4NysGXscClG4/eFmw/NlaoRIpZg+Pst2sAPSQTmWQUqDbctzlWqvE9a3bsefqdfSnZErx3Zaifvr5a02TezsMVzbRioHIxRgUK0wfkSup9+4dMH+tCd3P/j9lz/OqtWdq156iPYLV25x8OuuaDz4RsSGMEY/ob37eJ9Ia0ZHMgmlwh/3vFXLDJ7/oimSdjMExqcGyc98zaOfv7TKdz+SwqoIISSYfWV0iIk0cdey/vQa96velsvUYUueuICZmsQ8lyGeRk4k3rw8npy+3G2u+GHoXyPqfqySyRRBEJxKZUezT++12nS/bYuV7161guI1J/fOiwN7E88OP9wM3FptZVtajyzXKfmaO1huqIQQ5HK5WcC/s7i8B5w2JlJhZfF9XVkcjOxEphUedgKo42ZIJIfodA4hfQqrVqsxPz9/tlgsNpeXl1YBC9gApg2kejrc70GrPyQZ+g2tuwfQWkN5npcpFotvFQqFKtAFvD7M9f6oe323gPBf1EZDLBZ7bW5uLspms59LKfk/+mcA4mw4Jns1qKUAAAAASUVORK5CYII="></img>';
                                //not started // X.png
                                case '#ICON_3#':
                                    //metadata.css = 'ula-icon-1';
                                    return '<img class="ula-icon" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAACXBIWXMAAAsTAAALEwEAmpwYAAA4GmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS41LWMwMjEgNzkuMTU0OTExLCAyMDEzLzEwLzI5LTExOjQ3OjE2ICAgICAgICAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgICAgICAgICAgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIgogICAgICAgICAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgICAgICAgICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIj4KICAgICAgICAgPHhtcDpDcmVhdG9yVG9vbD5BZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpPC94bXA6Q3JlYXRvclRvb2w+CiAgICAgICAgIDx4bXA6Q3JlYXRlRGF0ZT4yMDE0LTA4LTE0VDE1OjAyOjE5LTA3OjAwPC94bXA6Q3JlYXRlRGF0ZT4KICAgICAgICAgPHhtcDpNb2RpZnlEYXRlPjIwMTQtMDgtMTRUMTU6MDU6MzEtMDc6MDA8L3htcDpNb2RpZnlEYXRlPgogICAgICAgICA8eG1wOk1ldGFkYXRhRGF0ZT4yMDE0LTA4LTE0VDE1OjA1OjMxLTA3OjAwPC94bXA6TWV0YWRhdGFEYXRlPgogICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3BuZzwvZGM6Zm9ybWF0PgogICAgICAgICA8cGhvdG9zaG9wOkNvbG9yTW9kZT4zPC9waG90b3Nob3A6Q29sb3JNb2RlPgogICAgICAgICA8eG1wTU06SW5zdGFuY2VJRD54bXAuaWlkOjExODgxMjdmLTRjYzUtYWQ0NC1hMTVkLTZiN2UwZGY3N2ZiZDwveG1wTU06SW5zdGFuY2VJRD4KICAgICAgICAgPHhtcE1NOkRvY3VtZW50SUQ+eG1wLmRpZDoxMTg4MTI3Zi00Y2M1LWFkNDQtYTE1ZC02YjdlMGRmNzdmYmQ8L3htcE1NOkRvY3VtZW50SUQ+CiAgICAgICAgIDx4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ+eG1wLmRpZDoxMTg4MTI3Zi00Y2M1LWFkNDQtYTE1ZC02YjdlMGRmNzdmYmQ8L3htcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOkhpc3Rvcnk+CiAgICAgICAgICAgIDxyZGY6U2VxPgogICAgICAgICAgICAgICA8cmRmOmxpIHJkZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmFjdGlvbj5jcmVhdGVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDppbnN0YW5jZUlEPnhtcC5paWQ6MTE4ODEyN2YtNGNjNS1hZDQ0LWExNWQtNmI3ZTBkZjc3ZmJkPC9zdEV2dDppbnN0YW5jZUlEPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6d2hlbj4yMDE0LTA4LTE0VDE1OjAyOjE5LTA3OjAwPC9zdEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6c29mdHdhcmVBZ2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpPC9zdEV2dDpzb2Z0d2FyZUFnZW50PgogICAgICAgICAgICAgICA8L3JkZjpsaT4KICAgICAgICAgICAgPC9yZGY6U2VxPgogICAgICAgICA8L3htcE1NOkhpc3Rvcnk+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgICAgIDx0aWZmOlhSZXNvbHV0aW9uPjcyMDAwMC8xMDAwMDwvdGlmZjpYUmVzb2x1dGlvbj4KICAgICAgICAgPHRpZmY6WVJlc29sdXRpb24+NzIwMDAwLzEwMDAwPC90aWZmOllSZXNvbHV0aW9uPgogICAgICAgICA8dGlmZjpSZXNvbHV0aW9uVW5pdD4yPC90aWZmOlJlc29sdXRpb25Vbml0PgogICAgICAgICA8ZXhpZjpDb2xvclNwYWNlPjY1NTM1PC9leGlmOkNvbG9yU3BhY2U+CiAgICAgICAgIDxleGlmOlBpeGVsWERpbWVuc2lvbj4xNTwvZXhpZjpQaXhlbFhEaW1lbnNpb24+CiAgICAgICAgIDxleGlmOlBpeGVsWURpbWVuc2lvbj4xNTwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIAo8P3hwYWNrZXQgZW5kPSJ3Ij8+FqklJAAAACBjSFJNAAB6JQAAgIMAAPn/AACA6QAAdTAAAOpgAAA6mAAAF2+SX8VGAAAA10lEQVR42qTTsUoDQRDG8V8kIFjZhQgWgq8gQiCFoCBCIMTaRwnHPYt9SBFCCFpExBew1TpogqilzVm4B5vDmFz8YIv9Zv+zy8xsJcsym6oKaZoW/QZOsYdX3GISH0iS5AeOtINrdAp+F0Nc4W3h5qBtPKG+5JUXeMYB3mErCvb/AHPtYpRvcvgI52vW6RjNGL4sWeh2DO+XhGsxPC0Jz2K4VxIexPAD7tYEH8PQLLSqhY8V4BfOiq2CTxziZgl4H+Ivv00YzEPmk7BqwZtgXMxW+c+v+h4AEygmxt9S3/wAAAAASUVORK5CYII="></img>';
                                default:
                                    return value;
                            }
                        }
                    });
                });
            } catch(e) {
                console.log(e);
            }
            ganttConfigStore.clearFilter();

            var staticColumns = [
                {
                    xtype : 'gridcolumn',
                    dataIndex: 'program',
                    header: 'Prog',
                    locked : false,
                    width: 60
                },{
                    xtype : 'gridcolumn',
                    dataIndex: 'tailNumber',
                    header: 'Tail Number',
                    locked : false,
                    width: 60
                },{
                    xtype : 'gridcolumn',
                    dataIndex: 'primaryMission',
                    header: 'Primary Mission',
                    locked : false,
                    width: 75
                },{
                    xtype: 'treecolumn',
                    header: 'Task Name',
                    locked : false,
                    dataIndex: 'Name',
                    width: 250,
                    iconCls :'no-icon',
                    bodyCssClass: 'x-tree-noicon',
                    renderer: function (value, metadata, record, rowIdx, colIdx, store, view){
                        var backgroundColor = record.get('color');
                        if (backgroundColor !== ""){
                            switch (backgroundColor) {
                                case 'red':
                                    metadata.style = "background-color:#ff6666;";
                                    return value;
                                case 'gray':
                                    metadata.style = "background-color:#b2b2b2";
                                    return value;
                                case 'orange':
                                    metadata.style = "background-color:#FFA500";
                                    return value;
                                case 'blue':
                                    metadata.style = "background-color:#7f7fff";
                                    return value;
                                case 'yellow':
                                    metadata.style = "background-color:#ffff00";
                                    return value;
                                case 'green':
                                    if (record.data.depth < 4) {
                                        metadata.style = "background-color:#397D02";
                                    }
                                    return value;
                                case 'lightBlue':
                                    return value;
                                case 'euTracker':
                                    return value;
                            }
                        } else {
                            return value;
                        }
                    }
                },{
                    xtype : 'startdatecolumn',
                    dateFormat: 'm/d/Y',
                    hidden: true
                },{
                    xtype : 'enddatecolumn',
                    dateFormat: 'm/d/Y',
                    hidden: true
                },{
                    //hidden : true,
                    xtype : 'baselinestartdatecolumn',
                    dateFormat: 'm/d/Y',
                    hidden: true
                },{
                    //hidden : true,
                    xtype : 'baselineenddatecolumn',
                    dateFormat: 'm/d/Y',
                    hidden: true
                },{
                    xtype : 'durationcolumn',
                    hidden: true
                },{
                    xtype : 'datecolumn',
                    dataIndex: 'actualStartDate',
                    header: 'Actual Start',
                    dateFormat: 'm/d/Y',
                    hidden: true
                },{
                    xtype : 'datecolumn',
                    dataIndex: 'actualEndDate',
                    header: 'Actual Finish',
                    dateFormat: 'm/d/Y',
                    hidden: true
                },{
                    xtype : 'percentdonecolumn',
                    width : 50,
                    hidden: true
                },{
                    xtype : 'predecessorcolumn',
                    hidden: true
                },{
                    xtype : 'notecolumn',
                    hidden: true
                },{
                    xtype : 'gridcolumn',
                    dataIndex: 'outline',
                    header: 'Outline',
                    hidden: true
                },{
                    xtype : 'gridcolumn',
                    dataIndex: 'color',
                    header: 'Color',
                    hidden: true
                }
            ];

            return staticColumns.concat(textArray);

        },

        onRefreshAndClearSort:function( btn, e, opts ) {
            var ganttPanel = Ext.ComponentManager.get('ganttPanel');
            var mainController = MyApp.app.getMainController();
            var store = ganttPanel.getStore();
            ganttPanel.setLoading(true);
            store.sorters.clear();
            mainController.collapseAll(ganttPanel);
            Ext.each(store.data.originalMap,function(key){
                var record = store.getById(key);
                record.childNodes = recurseRestoreChildrenOrder(record.childNodes);
                store.add(record);
            });
            ganttPanel.getView().refresh();
            setTimeout(function(){
                ganttPanel.setLoading(false);
            },1000);

            function recurseRestoreChildrenOrder(childNodes){
                var children = []
                if(childNodes.length > 1){
                    children = childNodes.sort(function(item1,item2){
                        if (item1.internalId < item2.internalId) {
                            return -1;
                        }
                        if (item1.internalId > item2.internalId) {
                            return 1;
                        }
                        return 0;
                    });

                }
                for(var i=0;i<childNodes.length;i++){
                    childNodes[i].childNodes = recurseRestoreChildrenOrder(childNodes[i].childNodes)
                }
                return children.length > 0 ? children : childNodes;
            }

        },

        onExpandClick: function(button, e, eOpts) {
            var me = this;
            var treePanel = Ext.ComponentManager.get('ganttPanel');
            me.getMyPanel().setLoading(true);
            Ext.defer(function(){
                me.expandAll(treePanel);
                me.getMyPanel().setLoading(false);
            }, 10);
        },

        onMinimizeClick: function(button, e, eOpts) {
            var me = this;
            var treePanel = Ext.ComponentManager.get('ganttPanel');
            me.getMyPanel().setLoading(true);
            Ext.defer(function(){
                me.collapseAll(treePanel);
                me.getMyPanel().setLoading(false);
            }, 10);
        },

        onPrintToPdfClick: function(button, e, eOpts) {
            var me = this;
            var store = Ext.getStore('InternalStore');
            var ganttPanel = Ext.ComponentManager.get('ganttPanel');
            var lockedGrid = ganttPanel.lockedGrid;
            var server = ganttPanel.getPlugin('exportServer');
            var main = MyApp.app.getController('Main');
            var time = new Date().getTime();
            var check = store.findExact('name','ganttViewChanged');
            if (check == -1) {
                main.changeGanttView('Year');
            }
            main.updateInternalStore('currentTime',time);
            server.printServer = window.printServer+window.namespace+'buildPDF.php?now='+time;
            server.printPDFServer = window.printServer+window.namespace+'createHtmlPage.php?now='+time;

            server.setFileFormat('pdf');
            ganttPanel.showExportDialog();
        },

        requestServer:function(){
            var me = this;
            return $.ajax({
                url: '/dsnwebui/dsnwebui_rest/ServerStoreXml',
                method: 'GET',
                success: function(res) {
                    var server = res.childNodes[0].textContent;
                    if(typeof server === 'undefined'){//res.getElementsByTagName("number")[0].firstChild.valueOf().textContent;
                        alert('No entry maintained for source server in Z051ULA_MD01');
                    }
                    me.setServer(server);
                },
                error: function(res) {
                    alert('No entry maintained for source server in Z051ULA_MD01');
                }
            });
        },

        setServer:function(server){
            return new Promise(function(resolve,reject){
                window.server = server;
                if(window.server.substr(window.server.length-1) !== '/'){
                    window.server += '/';
                }
                /**
                 * ***************************************************************************
                 * Use your own localhost here for window.printServer to access php api
                 * dev:  window.printServer = 'http://localhost:8999/'
                 * Comment out *********  window.printServer = window.server; ****************
                 * See SAP table z051ULA_md08 to reset the AWS server location ***************
                 * ***************************************************************************
                 */

                window.printServer = window.server;
                window.namespace = 'htmlToPdf/';
                window.serverResources = window.printServer+'resources/';

            });
        },

        onLaunch: function() {
            var me = this;
           var promise =  me.requestServer();
           /* development // me.setServer(window.location.protocol+'//'+ window.location.hostname+':'+window.location.port+'/')// */
           /* production //me.requestServer();*/
            /** TODO:
             * registerViewPreset: register a view preset for "manyYears" so as to remove override in gntPlugin.js
             *  See gntPlugin.js ln 10355
             */
            promise.done(function(){
                // get users

                me.getStore('UserStoreXml').load({
                    action: 'read',
                    scope: me
                });
                // get Selection Variants
                me.getStore('SelectionVariantStoreXml').load({
                    action: 'read',
                    scope: me
                });
                // get Column Variants
                me.getStore('ColumnStoreXml').load({
                    action: 'read',
                    scope: me
                });
                // get Materials
                me.getStore('PartNumberStoreXml').load({
                    action: 'read',
                    scope: me
                });
                //get Column Variants
                var ColumnVariantStoreXml = me.getStore('ColumnStoreXml').load({
                    action: 'read',
                    scope: me
                });
                //get Versions
                var VersionStoreXml = me.getStore('VersionStoreXml').load({
                    action: 'read',
                    scope: me
                });
                //get Params
                var ParamStoreXml = me.getStore('ParamStoreXml').load({
                    action: 'read',
                    scope: me
                });
                //get Tasks
                var taskStoreXml = me.getStore('taskStore').load({
                    action: 'read',
                    scope: me
                });
                //get Gantt Config
                var GanttConfigStoreXml = me.getStore('GanttConfigStoreXml').load({
                    action: 'read',
                    scope: me,
                    callback: function (){
                        var myPanel = Ext.widget('mypanel');
                        var mainView = Ext.ComponentManager.get('mainView');
                        mainView.insert(0,myPanel);
                        window.addEventListener("resize",function(){
                            myPanel.resizer.resizeTo(window.innerWidth,window.innerHeight);
                            console.log('resized window');
                        } ,false);
                    }
                });
                var SelectionVariantStoreXml = me.getStore('SelectionVariantStoreXml').load({
                    action: 'read',
                    scope: me
                });
                var SelectedObjectStoreXml = me.getStore('SelectedObjectStoreXml').load({
                    action: 'read',
                    scope: me
                });
                var PassedObjectsStoreXml = me.getStore('PassedObjectsStoreXml').load({
                    action: 'read',
                    scope: me,
                    callback: function () {
                        PassedObjectsStoreXml.each(//was : ParamStoreXml
                            function (record) {
                                var name = record.get('name');
                                var value = record.get('value');
                                var selectedStore = Ext.getStore('SelectedObjectStoreXml');
                                switch (name) {
                                    case 'network' :
                                        var networkParentNode = SelectedObjectStoreXml.getNodeById("networkParentNode");
                                        var networkChildNode = networkParentNode.appendChild({
                                            type: name,
                                            number: value,
                                            leaf: true
                                        });
                                        break;
                                    case 'material' :
                                        var materialParentNode = SelectedObjectStoreXml.getNodeById("materialParentNode");
                                        var materialChildNode = materialParentNode.appendChild({
                                            type: name,
                                            number: value,
                                            leaf: true
                                        });
                                        break;
                                    case 'plant' :
                                        var plantParentNode = SelectedObjectStoreXml.getNodeById("plantParentNode");
                                        var plantChildNode = plantParentNode.appendChild({
                                            type: name,
                                            number: value,
                                            leaf: true
                                        });
                                        break;
                                    case 'effectivity' :
                                        var effectivityParentNode = SelectedObjectStoreXml.getNodeById("effectivityParentNode");
                                        var effectivityChildNode = effectivityParentNode.appendChild({
                                            type: name,
                                            number: value,
                                            leaf: true
                                        });
                                        break;
                                    case 'program' :
                                        var programParentNode = SelectedObjectStoreXml.getNodeById("programParentNode");
                                        var programkChildNode = programParentNode.appendChild({
                                            type: name,
                                            number: value,
                                            leaf: true
                                        });
                                        break;
                                    case 'primaryMission' :
                                        var primaryMissionParentNode = SelectedObjectStoreXml.getNodeById("primaryMissionParentNode");
                                        var primaryMissionChildNode = primaryMissionParentNode.appendChild({
                                            type: name,
                                            number: value,
                                            leaf: true
                                        });
                                        break;
                                    case 'buildItem' :
                                        var buildItemParentNode = SelectedObjectStoreXml.getNodeById("buildItemParentNode");
                                        var buildItemChildNode = buildItemParentNode.appendChild({
                                            type: name,
                                            number: value,
                                            leaf: true
                                        });
                                        break;
                                    case 'tailNumber' :
                                        var tailNumberParentNode = SelectedObjectStoreXml.getNodeById("tailNumberParentNode");
                                        var tailNumberChildNode = tailNumberParentNode.appendChild({
                                            type: name,
                                            number: value,
                                            leaf: true
                                        });
                                        break;
                                    case 'name' :
                                        var nameParentNode = SelectedObjectStoreXml.getNodeById("nameParentNode");
                                        var nameChildNode = nameParentNode.appendChild({
                                            type: name,
                                            number: value,
                                            leaf: true
                                        });
                                        break;
                                    case 'notes' :
                                        var notesParentNode = SelectedObjectStoreXml.getNodeById("notesParentNode");
                                        var notesChildNode = notesParentNode.appendChild({
                                            type: name,
                                            number: value,
                                            leaf: true
                                        });
                                        break;
                                }
                            }
                        );
                    }
                });
                //Define Selected Objects Nodes
                var rootNode = SelectedObjectStoreXml.getRootNode();
                var networkNode = rootNode.appendChild({
                    id: 'networkParentNode',
                    type: "Network",
                    number: 'Network',
                    leaf: false
                });
                var materialNode = rootNode.appendChild({
                    id: "materialParentNode",
                    type: "Material",
                    number: "Material",
                    leaf: false
                });
                var effectivityNode = rootNode.appendChild({
                    id: "effectivityParentNode",
                    type: "Effectivity",
                    number: "Effectivity",
                    leaf: false
                });
                var plantNode = rootNode.appendChild({
                    id: "plantParentNode",
                    type: "Plant",
                    number: "Plant",
                    leaf: false
                });
                var programNode = rootNode.appendChild({
                    id: "programParentNode",
                    type: "Program",
                    number: "Program",
                    leaf: false
                });
                var primaryMissionNode = rootNode.appendChild({
                    id: "primaryMissionParentNode",
                    type: "Primary Mission",
                    number: "Primary Mission",
                    leaf: false
                });
                var buildItemNode = rootNode.appendChild({
                    id: "buildItemParentNode",
                    type: "Build Item",
                    number: "Build Item",
                    leaf: false
                });
                var tailNumberNode = rootNode.appendChild({
                    id: "tailNumberParentNode",
                    type: "Tail Number",
                    number: "Tail Number",
                    leaf: false
                });
                var nameNode = rootNode.appendChild({
                    id: "nameParentNode",
                    type: "Name",
                    number: "Name",
                    leaf: false
                });
                var notesNode = rootNode.appendChild({
                    id: "notesParentNode",
                    type: "Notes",
                    number: "Notes",
                    leaf: false
                });


            });


        },

        loadTaskStore: function(aufnr) {
            var me = this;

            me.TaskStoreXml.load({
                action: "read",
                scope: me,
                params: {aufnr: aufnr},
                listeners: {
                    'load' : function(taskStore, startDate) {
                        this.loaded=true;
                    }
                }
            });


        },

        init: function(application) {
            var me=this;
            window.appState = {};
            Ext.require('Gnt.model.Task');
            Ext.define('taskStoreModel', {
                extend : 'Gnt.model.Task',

                // A custom columns
                clsField : 'Test',
                autoCalculatePercentDoneForParentTask   : false,
                fields : [
                    { name : 'network', type : 'string' },
                    { name : 'outline', type : 'string' },
                    { name : 'color', type : 'string' },
                    { name : 'actualStartDate' },
                    { name : 'actualEndDate' },
                    { name : 'text01', type : 'string' },
                    { name : 'text02', type : 'string' },
                    { name : 'text03', type : 'string' },
                    { name : 'text04', type : 'string' },
                    { name : 'text05', type : 'string' },
                    { name : 'text06', type : 'string' },
                    { name : 'text07', type : 'string' },
                    { name : 'text08', type : 'string' },
                    { name : 'text09', type : 'string' },
                    { name : 'text10', type : 'string' },
                    { name : 'text11', type : 'string' },
                    { name : 'text12', type : 'string' },
                    { name : 'text13', type : 'string' },
                    { name : 'text14', type : 'string' },
                    { name : 'text15', type : 'string' },
                    { name : 'smDuration', type : 'string' },
                    { name : 'tailNumber', type : 'string' },//'tailNumber'
                    { name : 'primaryMission', type : 'string' },//'primaryMission'
                    { name : 'program', type : 'string' },//'program'
                    { name : 'taskDescription', type : 'string' },//'taskDescription'
                    { name : 'mission', type : 'string' },//'mission'
                    { name : 'majorBuildSequence', type : 'string' },//'majorBuildSequence'
                    { name : 'minorBuildSequence', type : 'string' }//'minorBuildSequence'
                ]
            });

            Ext.define('MyApp.model.Task', {
                extend                                  : 'Gnt.model.Task',
                autoCalculatePercentDoneForParentTask   : false
            });

            me.taskStore = Ext.create('Gnt.data.TaskStore', {
                autoLoad    : false,
                alias		: 'store.taskstore',
                storeId		: 'taskStore',
                model		: 'taskStoreModel',
                proxy       : {
                    type    : 'ajax',
                    url: '/dsnwebui/dsnwebui_rest/TaskStoreXml',
                    timeout: 3600000,
                    reader  : {
                        type: 'xml',
                        rootProperty: 'Tasks',
                        record: '>Task'
                    }
                }
            });


            this.control({
                "textfield#aufnr": {
                    keypress: this.onAufnrKeypress,
                    change: this.onAufnrChange
                },
                "container#eventTrigger": {
                    click: this.onButtonClick1,
                    ganttConfig: this.onEventTriggerGanttConfig
                },
                "#expand": {
                    click: this.onExpandClick
                },
                "#minimize": {
                    click: this.onMinimizeClick
                },
                "#printToPdf": {
                    click: this.onPrintToPdfClick
                },
                "#refresh": {
                    click: this.onRefreshAndClearSort
                }
            });
        },

        onTextFieldUpdate: function(field, newValue, oldValue, eOpts) {
            var me = this;
            var searchStore = Ext.getStore('SearchStoreXml');
            var parameters = {};
            searchStore.load ({
                parameters: {
                    name: field
                }
            });
        },

        expandAll: function(tree) {
            this.updateTreeView(tree, function(root) {
                var nodes = [];
                root.cascadeBy(function(node) {
                    if (!node.isRoot() || tree.rootVisible) {
                        node.data.expanded = true;
                        nodes.push(node);
                    }
                });
                return nodes;
            });

        },

        updateTreeView: function(tree, fn) {
            var view = tree.getView();
            view.getStore().loadRecords(fn(tree.getRootNode()));// undefined view.getStore().nodeStore
            view.refresh();

        },

        collapseAll: function(tree) {
            this.updateTreeView(tree, function(root) {
                root.cascadeBy(function(node) {
                    if (!node.isRoot() || tree.rootVisible) {
                        node.data.expanded = false;
                    }
                });
                return tree.rootVisible ? [root] : root.childNodes;
            });

        },

        updateInternalStore: function(name, value) {
            var internals = Ext.getStore('InternalStore');
            if (name!= -1 && value!= -1) {
                var check = internals.findExact('name',name);
                if (check == -1) {
                    internals.add({name: name,value: value});
                } else {
                    internals.removeAt(check);
                    internals.add({name: name,value: value});
                }
            }
        },

        getTime: function() {
            var internals = Ext.getStore('InternalStore');
            var now = internals.findExact('name','currentTime');
            if (now != -1) {
                now = internals.getAt(now).get('value');
                return now;
            } else {
                return '';
            }
        },

        getDeleteStore: function(globalIndex) {
            var store = Ext.getStore('SelectionVariantStoreXml'),
                ganttConfigStore = Ext.getStore('GanttConfigStoreXml');
            if (globalIndex != -1) {
                var globalValue = ganttConfigStore.getAt(globalIndex).get('value');
                if (globalValue == 'X') {
                    return store;
                } else {
                    store = minVariantStore(store);
                    return store;
                }
            } else {
                store = minVariantStore(store);
                return store;
            }
            function minVariantStore (variantStore) {
                for (var i=0; i < variantStore.data.length; i++) {
                    var type = variantStore.getAt(i).get('type');
                    if (type == 'G') {
                        variantStore.removeAt(i);
                    }
                }
                return variantStore;
            }
        },

        changeGanttView: function(type) {
            var me = this;
            var ganttViewStore = Ext.getStore('GanttViewStore');
            var ganttPanel = Ext.ComponentManager.get('ganttPanel');
            var ganttConfigStore = Ext.getStore('GanttConfigStoreXml');

            if(typeof type === 'undefined'){
                Ext.each(ganttViewStore.data.items,function(record){
                    if(record.get('selected')){
                        type = record.get('name');
                    }
                });
            }

            var startRecordIndex = -1,
                finishRecordIndex = -1,
                startRecord = {},
                finishRecord = {},
                startDatePad = '',
                startDate = new Date(),
                finishDate = new Date(),
                finishDatePad = '',
                startValue = startDate,
                finishValue = finishDate;

            switch (type){
                case 'Year':
                    finishRecordIndex = ganttConfigStore.findExact('name','finish');
                    if (finishRecordIndex > -1) {
                        finishRecord = ganttConfigStore.getAt(finishRecordIndex);
                        finishDate = finishRecord.get('value').length < 10 ? new Date().toString() :new Date(finishRecord.get('value').replace(/\D/ig,'-'));
                        //pad by a month to have extra space in view
                        finishDatePad = new Date(finishDate);
                        finishDatePad.setMonth(finishDatePad.getMonth()+20);
                        finishValue = new Date(finishDatePad);
                    }
                    //startDate
                    startRecordIndex = ganttConfigStore.findExact('name','start');
                    if (startRecordIndex > -1) {
                        startRecord = ganttConfigStore.getAt(startRecordIndex);
                        startDate = startRecord.get('value').length < 10 ? finishValue.toString() : new Date(startRecord.get('value').replace(/\D/ig,'-'));
                        //pad by 30 days to have extra space in view
                        startDatePad = new Date(startDate);
                        startDatePad.setMonth(startDatePad.getMonth()-20);
                        startValue = new Date(startDatePad);
                    }
                    ganttPanel.switchViewPreset('manyYears',new Date(startValue), new Date(finishValue));
                    ganttPanel.timeAxisViewModel.setForceFit(true);
                break;
                case 'Month & Year':
                    //finishDate
                    finishRecordIndex = ganttConfigStore.findExact('name','finish');
                    if (finishRecordIndex  > -1) {
                        finishRecord = ganttConfigStore.getAt(finishRecordIndex);
                        finishDate = finishRecord.get('value').length < 10 ? new Date().toString() :  new Date(finishRecord.get('value').replace(/\D/ig,'-'));
                        //pad by a month to have extra space in view
                        finishDatePad = new Date(finishDate);
                        finishDatePad.setMonth(finishDatePad.getMonth()+12);
                        finishValue = new Date(finishDatePad);
                    }
                    //startDate
                    startRecordIndex = ganttConfigStore.findExact('name','start');
                    if (startRecordIndex  > -1) {
                        startRecord = ganttConfigStore.getAt(startRecordIndex);
                        startDate = startRecord.get('value').length < 10 ? finishValue.toString() : new Date(startRecord.get('value').replace(/\D/ig,'-'));
                        //pad by 30 days to have extra space in view
                        startDatePad = new Date(startDate);
                        startDatePad.setMonth(startDatePad.getMonth()-12);
                        startValue = new Date(startDatePad);
                    }
                    ganttPanel.switchViewPreset('monthAndYear',new Date(startValue), new Date(finishValue));
                    ganttPanel.timeAxisViewModel.setForceFit(false);
                    break;
                case 'Week & Month':
                    //finishDate
                    finishRecordIndex = ganttConfigStore.findExact('name','finish');
                    if (finishRecordIndex  > -1) {
                        finishRecord = ganttConfigStore.getAt(finishRecordIndex);
                        finishDate = finishRecord.get('value').length < 10 ? new Date().toString() :new Date(finishRecord.get('value').replace(/\D/ig,'-'));
                        //pad by a month to have extra space in view
                        finishDatePad = new Date(finishDate);
                        finishDatePad.setMonth(finishDatePad.getMonth()+6);
                        finishValue = new Date(finishDatePad);
                    }
                    //startDate
                    startRecordIndex = ganttConfigStore.findExact('name','start');
                    if (startRecordIndex  > -1) {
                        startRecord = ganttConfigStore.getAt(startRecordIndex);
                        startDate = startRecord.get('value').length < 10 ? finishValue.toString() : new Date(startRecord.get('value').replace(/\D/ig,'-'));
                        //pad by 30 days to have extra space in view
                        startDatePad = new Date(startDate);
                        startDatePad.setMonth(startDatePad.getMonth()-6);
                        startValue = new Date(startDatePad);
                    }
                    ganttPanel.switchViewPreset('weekAndMonth',new Date(startValue), new Date(finishValue));
                    ganttPanel.timeAxisViewModel.setForceFit(false);
                    break;
                case 'Week & Day':
                    //finishDate
                    finishRecordIndex = ganttConfigStore.findExact('name','finish');
                    if (finishRecordIndex  > -1) {
                        finishRecord = ganttConfigStore.getAt(finishRecordIndex);
                        finishDate = finishRecord.get('value').length < 10 ? new Date().toString() :new Date(finishRecord.get('value').replace(/\D/ig,'-'));
                        //pad by a month to have extra space in view
                        finishDatePad = new Date(finishDate);
                        finishDatePad.setMonth(finishDatePad.getMonth()+4);
                        finishValue = new Date(finishDatePad);
                    }
                    //startDate
                    startRecordIndex = ganttConfigStore.findExact('name','start');
                    if (startRecordIndex  > -1) {
                        startRecord = ganttConfigStore.getAt(startRecordIndex);
                        startDate = startRecord.get('value').length < 10 ? finishValue.toString() : new Date(startRecord.get('value').replace(/\D/ig,'-'));
                        //pad by 30 days to have extra space in view
                        startDatePad = new Date(startDate);
                        startDatePad.setMonth(startDatePad.getMonth()-4);
                        startValue = new Date(startDatePad);
                    }
                    ganttPanel.switchViewPreset('weekAndDay',new Date(startValue), new Date(finishValue));
                    ganttPanel.timeAxisViewModel.setForceFit(false);
                    break;
                default:
                case 'Year & Quarter':
                    //finishDate
                    finishRecordIndex = ganttConfigStore.findExact('name','finish');
                    if (finishRecordIndex  > -1) {
                        finishRecord = ganttConfigStore.getAt(finishRecordIndex);
                        finishDate = finishRecord.get('value').length < 10 ? new Date().toString() :new Date(finishRecord.get('value').replace(/\D/ig,'-'));
                        //pad by a month to have extra space in view
                        finishDatePad = new Date(finishDate);
                        finishDatePad.setMonth(finishDatePad.getMonth()+20);
                        finishValue = new Date(finishDatePad);
                    }
                    //startDate
                    startRecordIndex = ganttConfigStore.findExact('name','start');
                    if (startRecordIndex  > -1) {
                        startRecord = ganttConfigStore.getAt(startRecordIndex);
                        startDate = startRecord.get('value').length < 10 ? finishValue.toString() : new Date(startRecord.get('value').replace(/\D/ig,'-'));
                        //pad by 30 days to have extra space in view
                        startDatePad = new Date(startDate);
                        startDatePad.setMonth(startDatePad.getMonth()-20);
                        startValue = new Date(startDatePad);
                    }
                    ganttPanel.switchViewPreset('year',new Date(startValue), new Date(finishValue));
                    ganttPanel.timeAxisViewModel.setForceFit(false);
                    break;
            }
            //ganttPanel.timeAxisViewModel.setForceFit(true);
           // ganttPanel.timeAxisViewModel.setAvailableWidth(ganttPanel.timeAxisViewModel.getAvailableWidth)
            //ganttPanel.timeAxisViewModel.update()
           // ganttPanel.timeAxisViewModel.fitToAvailableWidth()
        },

        updateStatusDate: function() {
            var me = this,
                lineStore = Ext.getStore('lineStore'),
                ganttConfigStore = Ext.getStore('GanttConfigStoreXml'),
                date = ganttConfigStore.getAt(ganttConfigStore.findExact('name','statusDate')).get('value');
            lineStore.removeAll();
            lineStore.add({
                Date: new Date(date),
                Text: 'Status Date',
                Cls: 'important'
            });
        },

        getStatusDate: function() {
            var ganttConfigStore = Ext.getStore('GanttConfigStoreXml'),
                date = ganttConfigStore.getAt(ganttConfigStore.findExact('name','statusDate')).get('value');
            date = String(date).split(",");
            var myYr = date[0];
            var myMth = date[1];
            var myDay = date[2];
            date = myMth+ "/"+myDay+"/"+myYr;
            return date;
        },

        getHeaderTpl: function () {
            var main = MyApp.app.getController('Main'),
                statusDate = main.getStatusDate(),
                tpl = new Ext.XTemplate(
                        '<tpl if="showHeader">' +
                            '<div class="ula-print-header" style="width:{totalWidth}px"><p>{pageNo}/{totalPages}</p></div>' +
                        '</tpl>' +

                        '<tpl>' +
                            '<div class="ula-print-header" style="max-height:59px;overflow:hidden;float:left;width: 100%;">' +

                                '<div class="ula-print-header-text" style="width:20%;float:left;padding:3px 0 0 5px;">'+
                       '<img data-id="ula-logo_left_tplExport.jpg" src="data:image/jpeg;base64,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" width="85px"></img>' +
                                    '<p style="margin:1px 0px; padding: 0px;">Status Date: {[this.getStatusDate()]}</p>' +
                                '</div>'+
                                '<div style="width:60%;float:left;text-align:center;color:#272e8b;">'+
                                        '<h2 style="margin:5px 0 2px 0;"><b>MASTER PRODUCTION SCHEDULE (MPS)</b></h2>' +
                                        '<p style="margin:1px 0px; padding: 0px;">{[this.getPrintTitle()]}</p>' +
                                        '<p style="margin:1px 0px; padding: 0px;">~ ULA Proprietary Information ~</p>' +
                                '</div>'+
                                '<div style="width:20%;float:left;text-align:right;">'+
                                    '<img data-id="perfectproduct_200x_right_tplExport.jpg" src="data:image/jpeg;base64,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" width="95px" align="right"></img>' +
                                '</div>'+


                            '</div>' +

                        '</tpl>',
                    {
                        disableFormats: true,
                        getStatusDate: function () {
                            var main = MyApp.app.getController('Main');
                            var statusDate = main.getStatusDate();
                            return statusDate;
                        },
                        getPrintTitle: function () {
                            var configStore = Ext.getStore('GanttConfigStoreXml');
                            var printTitle = configStore.findExact('name', 'printTitle');
                            if (printTitle !== -1) {
                                printTitle = configStore.getAt(printTitle).get('value');
                            } else {
                                printTitle = '';
                            }
                            return printTitle;
                        }
                    }
                );
            return tpl;
        },

        getFooterTpl: function () {
            var main = MyApp.app.getController('Main'),
                tpl = new Ext.XTemplate('<tpl>' +
                            '<div class="ula-print-footer">' +
                                '<div style="width:32%;float:left;text-align:left;">{[this.getPrintFooterLeft()]}</div>'+
                                '<div style="width:32%;float:left;text-align:center;">Page {pageNo}</div>'+
                                '<div style="width:32%;float:left;text-align:right;">{[this.getPrintFooterRight()]}</div>'+
                            '</div>' +
                        '</tpl>',
                    {
                        getPrintFooterRight: function () {
                            var configStore = Ext.getStore('GanttConfigStoreXml');
                            var printFooterRight = configStore.findExact('name', 'printFooterRight');
                            if (printFooterRight !== -1) {
                                var checkVAl = configStore.getAt(printFooterRight).get('value');
                                printFooterRight = Ext.isDefined(checkVAl) ? checkVAl : '';
                                printFooterRight.replace(/(\r\n|\n|\r)/g, "<br>");
                            } else {
                                printFooterRight = '';
                            }
                            return printFooterRight;
                        },
                        getPrintFooterLeft: function () {
                            var configStore = Ext.getStore('GanttConfigStoreXml');
                            var printFooterLeft = configStore.findExact('name', 'printFooterLeft');
                            if (printFooterLeft !== -1) {
                                var checkVAl = configStore.getAt(printFooterLeft).get('value');
                                printFooterLeft = Ext.isDefined(checkVAl) ? checkVAl : '';
                                printFooterLeft.replace(/(\r\n|\n|\r)/g, "<br>");
                            } else {
                                printFooterLeft = '';
                            }
                            return printFooterLeft;
                        },
                        getPrintFooterCenter: function () {
                            var configStore = Ext.getStore('GanttConfigStoreXml');
                            var printFooterCenter = configStore.findExact('name', 'printFooterCenter');
                            if (printFooterCenter !== -1) {
                                var checkVAl = configStore.getAt(printFooterCenter).get('value');
                                printFooterCenter = Ext.isDefined(checkVAl) ? checkVAl : '';
                                printFooterCenter.replace(/(\r\n|\n|\r)/g, "<br>");
                            } else {
                                printFooterCenter = '';
                            }
                            return printFooterCenter;
                        }
                    }
                );
            return tpl;
        },

        getBodyTpl:function(){
            var main = MyApp.app.getController('Main'),
                statusDate = main.getStatusDate(),
                //framework/extra/
                //framework/extra/
                tpl = new Ext.XTemplate('<!DOCTYPE html>' +
                    '<html class="' + Ext.baseCSSPrefix + 'border-box {htmlClasses}" style="background-color:white !important">' +
                    '<head>' +
                    '<meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />' +
                    '<title>{title}</title>' +
                    '{styles}' +
                    '</head>' +
                        '<body class="' + Ext.baseCSSPrefix + 'webkit sch-export {bodyClasses}" style="background-color:white !important">' +
                            '{header}' +
                            '<div style="width:100%" align="center">' +
                                     '<tpl if="totalWidth = 100">'+
                    '<div class="{componentClasses}" id="body" align="left" style="height:{bodyHeight}px; width:{totalWidth}%; position: relative !important">' +
                                     '<tpl else>'+
                    '<div class="{componentClasses}" align="left" style="height:{bodyHeight}px; width:{totalWidth}px; position: relative !important">' +
                                     '</tpl>'+
                                '{HTML}' +
                            '</div></div>' +
                            '{footer}' +
                        '</body>' +
                    '</html>',
                    {}
                );
            return tpl;
        },

        _depricated__getTpl: function() {
            var main = MyApp.app.getController('Main'),
                statusDate = main.getStatusDate(),
                //framework/extra/
                //framework/extra/
                tpl = new Ext.XTemplate('<!DOCTYPE html>' +
                    '<html class="' + Ext.baseCSSPrefix + 'border-box {htmlClasses}" style="background-color:white !important">' +
                        '<head>' +
                        '<meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />' +
                        '<title>{column}/{row}</title>' +
                        '{styles}' +
                        '</head>' +
                        '<body class="' + Ext.baseCSSPrefix + 'webkit sch-export {bodyClasses}" style="background-color:white !important">' +
                            '<tpl if="showHeader">' +
                                '<div class="ula-print-header" style="width:{totalWidth}px"><p>{column}/{row}</p></div>' +
                            '</tpl>' +
                            '<tpl>' +
                                '<div class="ula-print-header">' +
                                        //'<img src="'+window.server+'images/ula-logo-2.jpg" width="100px" align="right"></img>' +
                                        '<img src="'+window.server+'images/ula-logo-op.jpg" width="100px" align="left"></img>' +
                                        '<h4>MASTER PRODUCTION SCHEDULE (MPS)</h4>' +
                                        '<h5>{[this.getPrintTitle()]}</h5>' +
                                        '<p>~ United Launch Alliance (ULA) Proprietary Information ~</p>' +
                                '</div>' +
                                '<div class="ula-print-header-text">' +
                                    '<h5>Status Date: {[this.getStatusDate()]}</h5>' +
                                '</div>' +
                            '</tpl>' +
                            '<tpl>' +
                                '<div class="{componentClasses}" style="height:{bodyHeight}px; width:{totalWidth}px; position: relative !important">' +
                                    '{HTML}' +
                                '</div>' +
                            '</tpl>' +
                            '<tpl>' +
                                '<div class="ula-print-footer">' +
                                    '<p><div style="float:left; text-align:left; margin:-5px 0 0 0 !important">{[this.getPrintFooterLeft()]}</div></p>' +
                                    '<p><div style="float: right; text-align:right; margin:-5px 0 0 0 !important">{[this.getPrintFooterRight()]}</div></p>' +
                                    '<p>Page {row}</p>' +
                                '</div>' +
                            '</tpl>' +
                        '</body>' +
                    '</html>',
                    {
                        disableFormats: true,
                        getStatusDate: function() {
                            var main = MyApp.app.getController('Main');
                            var statusDate = main.getStatusDate();
                            return statusDate;
                        },
                        getPrintTitle: function() {
                            var configStore = Ext.getStore('GanttConfigStoreXml');
                            var printTitle = configStore.findExact('name','printTitle');
                            if (printTitle !== -1) {
                                printTitle = configStore.getAt(printTitle).get('value');
                            } else {
                                printTitle = '';
                            }
                            return printTitle;
                        },
                        getPrintFooterRight: function() {
                            var configStore = Ext.getStore('GanttConfigStoreXml');
                            var printFooterRight = configStore.findExact('name','printFooterRight');
                            if (printFooterRight !== -1){
                                printFooterRight = configStore.getAt(printFooterRight).get('value');
                                printFooterRight.replace(/(\r\n|\n|\r)/g,"<br>");
                            } else {
                                printFooterRight = '';
                            }
                            return printFooterRight;
                        },
                        getPrintFooterLeft: function() {
                            var configStore = Ext.getStore('GanttConfigStoreXml');
                            var printFooterLeft = configStore.findExact('name','printFooterLeft');
                            if (printFooterLeft !== -1){
                                printFooterLeft = configStore.getAt(printFooterLeft).get('value');
                                printFooterLeft.replace(/(\r\n|\n|\r)/g,"<br>");
                            } else {
                                printFooterLeft ='';
                            }
                            return printFooterLeft;
                        },
                        getPrintFooterCenter: function() {
                            var configStore = Ext.getStore('GanttConfigStoreXml');
                            var printFooterCenter = configStore.findExact('name','printFooterCenter');
                            if (printFooterCenter !== -1) {
                                printFooterCenter = configStore.getAt(printFooterCenter).get('value');
                                printFooterCenter.replace(/(\r\n|\n|\r)/g,"<br>");
                            } else {
                                printFooterCenter = '';
                            }
                            return printFooterCenter;
                        }
                    }
                );
            return tpl;
        }

    });



