<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js"><span id='Sch-widget-ExportDialog'>/**
</span> @class Sch.widget.ExportDialog
 @private
 @extends Ext.window.Window

 Widget for export options.

 */
Ext.define('Sch.widget.ExportDialog', {
    alternateClassName   : 'Sch.widget.PdfExportDialog',
    extend               : 'Ext.window.Window',
    requires             : [
        'Ext.ProgressBar',
        'Sch.widget.ExportDialogForm'
    ],
    mixins               : ['Sch.mixin.Localizable'],
    alias                : &quot;widget.exportdialog&quot;,

<span id='Sch-widget-ExportDialog-cfg-l10n'>    /**
</span>     * @cfg {Object} l10n
     * A object, purposed for the class localization. Contains the following keys/values:

            - title            : 'Export Settings',
            - exportButtonText : 'Export',
            - cancelButtonText : 'Cancel',
            - progressBarText  : 'Exporting...'
     */

    width                : 450,
<span id='Sch-widget-ExportDialog-property-cls'>    cls                  : 'sch-exportdialog',
</span><span id='Sch-widget-ExportDialog-property-frame'>    frame                : false,
</span><span id='Sch-widget-ExportDialog-property-layout'>    layout               : 'fit',
</span><span id='Sch-widget-ExportDialog-property-draggable'>    draggable            : true,
</span>
<span id='Sch-widget-ExportDialog-cfg-progressBar'>    /**
</span>     * @cfg {Ext.Component} progressBar Progress bar component.
     */
    progressBar          : null,

<span id='Sch-widget-ExportDialog-cfg-buttonsPanel'>    /**
</span>     * @cfg {Ext.Component} buttonsPanel Component with buttons controlling export.
     */
    buttonsPanel         : null,

<span id='Sch-widget-ExportDialog-cfg-buttonsPanelScope'>    /**
</span>     * @cfg {Object} buttonsPanelScope
     * The scope for the {@link #buttonsPanel}
     */
    buttonsPanelScope    : null,

<span id='Sch-widget-ExportDialog-cfg-dateRangeFormat'>    /**
</span>     * @cfg {String} dateRangeFormat Valid date format to be used by the date range fields (&quot;Export from&quot; and &quot;Export to&quot; fields).
     */

<span id='Sch-widget-ExportDialog-cfg-showHeaderField'>    /**
</span>     * @cfg {Boolean} showHeaderField Indicates if the &quot;Add page number&quot; checkbox should be displayed in the export dialog.
     * @removed This config was renamed since the name was used by another existing property. Please use {@link #showShowHeaderField} instead.
     */
<span id='Sch-widget-ExportDialog-cfg-showShowHeaderField'>    /**
</span>     * @cfg {Boolean} showShowHeaderField Indicates if the &quot;Add page number&quot; checkbox should be displayed in the export dialog.
     */

<span id='Sch-widget-ExportDialog-cfg-showFooterField'>    /**
</span>     * @cfg {Boolean} showFooterField Indicates if the &quot;Add footer&quot; checkbox should be displayed in the export dialog.
     * @removed This config was renamed since the name was used by another existing property. Please use {@link #showShowFooterField} instead.
     */
<span id='Sch-widget-ExportDialog-cfg-showShowFooterField'>    /**
</span>     * @cfg {Boolean} showShowFooterField Indicates if the &quot;Add footer&quot; checkbox should be displayed in the export dialog.
     */

<span id='Sch-widget-ExportDialog-cfg-showColumnPicker'>    /**
</span>     * @cfg {Boolean} showColumnPicker Indicates if the &quot;Select columns for export&quot; field should to be shown in the export dialog.
     */

<span id='Sch-widget-ExportDialog-cfg-columnPickerConfig'>    /**
</span>     * @cfg {Object} columnPickerConfig Configuration for the &quot;Select columns for export&quot; field.
     */

<span id='Sch-widget-ExportDialog-cfg-showDPIField'>    /**
</span>     * @cfg {Boolean} showDPIField Indicates if the &quot;DPI (dots per inch)&quot; field should to be shown in the export dialog.
     */

<span id='Sch-widget-ExportDialog-cfg-dpiFieldConfig'>    /**
</span>     * @cfg {Object} dpiFieldConfig Configuration for the &quot;DPI (dots per inch)&quot; field
     */

<span id='Sch-widget-ExportDialog-cfg-showResizePicker'>    /**
</span>     * @cfg {Boolean} showResizePicker Indicates if &quot;Resize column/rows to desired value&quot; panel should to be shown in the export dialog.
     * @removed This config was renamed because the name was used by an existing property. Please use {@link #showShowResizePicker} instead.
     */
<span id='Sch-widget-ExportDialog-cfg-showShowResizePicker'>    /**
</span>     * @cfg {Boolean} showShowResizePicker Indicates if &quot;Resize column/rows to desired value&quot; panel should to be shown in the export dialog.
     */

<span id='Sch-widget-ExportDialog-cfg-dateRangeRestriction'>    /**
</span>     * @cfg {Boolean} dateRangeRestriction Set to &quot;false&quot; to disable the maximum and minimum allowed value limits for the date range fields (&quot;Export from&quot; and &quot;Export to&quot; fields).
     */

    form                 : null,

<span id='Sch-widget-ExportDialog-property-defaultFormXType'>    defaultFormXType     : 'export_dialog_form',
</span>
<span id='Sch-widget-ExportDialog-property-exportButtonConfig'>    exportButtonConfig   : null,
</span><span id='Sch-widget-ExportDialog-property-cancelButtonConfig'>    cancelButtonConfig   : null,
</span>
<span id='Sch-widget-ExportDialog-property-formConfigs'>    formConfigs          : 'pageFormats,startDate,endDate,rowHeight,columnWidth,defaultExporter,exporters,dateRangeFormat,exportConfig,showColumnPicker,columnPickerConfig,showShowHeaderField,'+
</span>        'showShowFooterField,showResizePicker,stateful,stateId,dateRangeRestriction,showRowsRangeField,'+
        'rowsRangeFieldConfig,rangeFieldConfig,formatFieldConfig,orientationFieldConfig,exportersFieldConfig',

<span id='Sch-widget-ExportDialog-method-constructor'>    constructor : function (config) {
</span>        Ext.apply(this, config);

        this.title = this.title || this.L('title');

        this.callParent(arguments);
    },


<span id='Sch-widget-ExportDialog-method-mapFormConfigs'>    // Some form configs can be provided directly to the dialog.
</span>    // Their names are listed in &quot;formConfigs&quot; property.
    mapFormConfigs : function () {
        this.form = this.form || {};

        var form  = this.form;

        var names = this.formConfigs.split(',');

        for (var i = 0, n = names.length; i &lt; n; i++) {
            var name = names[i];

            if (this.hasOwnProperty(name) &amp;&amp; !form.hasOwnProperty(name)) {
                form[name] = this[name];
            }
        }

        // TODO: backward compatibility
        if (this.hasOwnProperty('showFooterField') &amp;&amp; !form.hasOwnProperty('showShowFooterField')) {
            form.showShowFooterField = this.showFooterField;
        }

        // TODO: backward compatibility
        if (this.hasOwnProperty('showHeaderField') &amp;&amp; !form.hasOwnProperty('showShowHeaderField')) {
            form.showShowHeaderField = this.showHeaderField;
        }
    },



<span id='Sch-widget-ExportDialog-method-initComponent'>    initComponent : function () {
</span>        var me          = this;

        if (!me.form || !me.form.isForm) {
            me.mapFormConfigs();

            me.form = me.buildForm();
        }

        Ext.apply(me, {
            items : {
                items : [
                    me.form,
                    me.progressBar || me.buildProgressBar()
                ]
            },

            fbar  : me.buildButtons(me.buttonsPanelScope || me)
        });

        me.callParent(arguments);
    },

<span id='Sch-widget-ExportDialog-method-afterRender'>    afterRender : function () {
</span>        var me = this;

        if (me.form.resizePicker) {
            me.relayEvents(me.form.resizePicker, ['change', 'changecomplete', 'select']);
        }

        me.callParent(arguments);
    },

<span id='Sch-widget-ExportDialog-method-buildButtons'>    /**
</span>     * Create Dialog's buttons.
     *
     * @param {Object} buttonsScope Scope for the buttons.
     * @return {Object[]} buttons Array containing buttons definition for Exporting/Cancelling export.
     */
    buildButtons : function (buttonsScope) {
        return [
            Ext.apply({
                xtype   : 'button',
                scale   : 'medium',
                text    : this.L('exportButtonText'),
                handler : this.onExportButtonPress,
                scope   : buttonsScope
            }, this.exportButtonConfig),
            Ext.apply({
                xtype   : 'button',
                scale   : 'medium',
                text    : this.L('cancelButtonText'),
                handler : this.onCancelButtonPress,
                scope   : buttonsScope
            }, this.cancelButtonConfig)
        ];
    },


<span id='Sch-widget-ExportDialog-method-onExportButtonPress'>    onExportButtonPress : function () {
</span>        if (this.form.isValid()) {
            var config          = this.form.getValues();

            // convert strings to dates before passing date range to doExport method
            var dateFormat      = this.dateRangeFormat || Ext.Date.defaultFormat;

            if (config.dateFrom &amp;&amp; !Ext.isDate(config.dateFrom)) {
                config.dateFrom = Ext.Date.parse(config.dateFrom, dateFormat);
            }

            if (config.dateTo &amp;&amp; !Ext.isDate(config.dateTo)) {
                config.dateTo   = Ext.Date.parse(config.dateTo, dateFormat);
            }

            this.doExportFn.call(this.doExportFnScope || this, config);
        }
    },


<span id='Sch-widget-ExportDialog-method-onCancelButtonPress'>    onCancelButtonPress : function () {
</span>        this.destroy();
    },


<span id='Sch-widget-ExportDialog-method-buildForm'>    /**
</span>     * Build the {@link Sch.widget.ExportDialogForm} for the dialog window.
     *
     * @param {Object} config Config object for the form, containing field names and values.
     * @return {Sch.widget.ExportDialogForm} form
     */
    buildForm : function (config) {
        this.form = Ext.apply(this.form || {}, config);

        return Ext.ComponentManager.create(this.form, this.defaultFormXType);
    },


<span id='Sch-widget-ExportDialog-method-buildProgressBar'>    buildProgressBar : function () {
</span>        return this.progressBar = new Ext.ProgressBar({
            text    : this.L('progressBarText'),
            animate : true,
            hidden  : true,
            margin  : '4px 10px 10px 10px'
        });
    }

});
</pre>
</body>
</html>
